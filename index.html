<!doctype html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Panel de Importaciones | Fenix</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <div class="bg-shape shape-a"></div>
  <div class="bg-shape shape-b"></div>
  <div class="bg-shape shape-c"></div>

  <main class="app-shell">
    <header class="topbar card">
      <div>
        <p class="eyebrow">Supabase Â· public.Import</p>
        <h1>Panel de Importaciones</h1>
        <p class="subtitle">Analisis por marcas, cantidades y fechas de llegada con alertas automaticas.</p>
      </div>
      <div class="topbar-actions">
        <button id="refreshBtn" class="btn">Actualizar</button>
        <p id="lastSync" class="muted">Sin sincronizar</p>
      </div>
    </header>

    <section id="statusBox" class="status-box"></section>
    <section class="filters card">
      <div class="filter-item">
        <label for="brandFilter">Marca</label>
        <select id="brandFilter">
          <option value="__ALL__">Todas las marcas</option>
        </select>
      </div>
      <div class="filter-item">
        <label for="providerFilter">Proveedor</label>
        <select id="providerFilter">
          <option value="__ALL__">Todos los proveedores</option>
        </select>
      </div>
      <div class="filter-item">
        <label for="categoryFilter">Tipo de articulo</label>
        <select id="categoryFilter">
          <option value="__ALL__">Todos los tipos</option>
        </select>
      </div>
      <div class="filter-item">
        <label for="statusFilter">Estado llegada</label>
        <select id="statusFilter">
          <option value="all">Todos</option>
          <option value="on_time">En tiempo</option>
          <option value="overdue">Atrasado</option>
        </select>
      </div>
      <div class="filter-item">
        <label for="sortFilter">Orden</label>
        <select id="sortFilter">
          <option value="arrival_asc">Fecha llegada (menor a mayor)</option>
          <option value="arrival_desc">Fecha llegada (mayor a menor)</option>
          <option value="qty_asc">Cantidad (menor a mayor)</option>
          <option value="qty_desc">Cantidad (mayor a menor)</option>
          <option value="brand_asc">Marca (A-Z)</option>
          <option value="brand_desc">Marca (Z-A)</option>
        </select>
      </div>
    </section>

    <section class="kpi-grid" id="kpiGrid">
      <article class="kpi card"><p>Total registros</p><h3 id="kpiRows">-</h3></article>
      <article class="kpi card"><p>Total cantidad</p><h3 id="kpiQty">-</h3></article>
      <article class="kpi card"><p>Marcas unicas</p><h3 id="kpiBrands">-</h3></article>
      <article class="kpi card"><p>Llegan en 7 dias</p><h3 id="kpiSoon">-</h3></article>
      <article class="kpi card"><p>Atrasadas</p><h3 id="kpiOverdue">-</h3></article>
      <article class="kpi card"><p>Proxima llegada</p><h3 id="kpiNext">-</h3></article>
    </section>

    <section class="layout-two">
      <article class="card panel">
        <div class="panel-head">
          <h2>Alertas de llegada</h2>
          <span class="chip" id="alertCount">0</span>
        </div>
        <div id="alertsList" class="alerts-list"></div>
      </article>

      <article class="card panel">
        <div class="panel-head">
          <h2>Mix por marca</h2>
        </div>
        <div id="brandBars" class="bars"></div>
      </article>
    </section>

    <section class="layout-two">
      <article class="card panel">
        <div class="panel-head">
          <h2>Proximas llegadas</h2>
          <button id="exportArrivalsBtn" class="btn-soft">Exportar Excel</button>
        </div>
        <div class="table-wrap arrivals-scroll" id="arrivalTableWrap">
          <table>
            <thead>
              <tr>
                <th>Marca</th>
                <th>Cantidad</th>
                <th>Fecha llegada</th>
                <th>Tiempo</th>
                <th>Estado</th>
              </tr>
            </thead>
            <tbody id="arrivalTable"></tbody>
          </table>
        </div>
      </article>

      <article class="card panel">
        <div class="panel-head">
          <h2>Llegadas por mes</h2>
        </div>
        <div id="arrivalMonthBars" class="month-bars"></div>
      </article>
    </section>

    <section class="card panel" id="rawSection">
      <div class="panel-head">
        <h2>Vista rapida de registros</h2>
        <div class="panel-actions">
          <button id="toggleRawBtn" class="btn-soft">Mostrar mas</button>
          <button id="exportRawBtn" class="btn-soft">Exportar Excel</button>
        </div>
      </div>
      <div id="rawCollapse" class="raw-collapse is-collapsed">
        <div id="rawTableWrap" class="table-wrap"></div>
      </div>
    </section>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="./main.js" defer></script>
</body>
</html>
